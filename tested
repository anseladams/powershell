# powershell


"Get AD groups"
----------------------------------

##ADGroups + Name + GroupCategory + Members
$adgroups = Get-ADGroup -Filter "name -like '*ggilje*'" | sort name

$data = foreach ($adgroup in $adgroups) {
    $members = $adgroup | get-adgroupmember | sort name
    foreach ($member in $members) {
        [PSCustomObject]@{
            Group   = $adgroup.name
            Members = $member
        }
    }
}

$data | export-csv "$env:userprofiles\desktop\groupinfo.csv" -NoTypeInformation

##
$Groups = Get-ADGroup -Properties * -Filter * -SearchBase "OU=Groups,OU=GSA,DC=USER,DC=root,DC=acgov,DC=org" 
Foreach($G In $Groups)
{
    Write-Host $G.Name
    Write-Host "-------------"
    $G.Members } 
    
    ##get a SID
    C:\Windows\System32\wbem>wmic useraccount where name="XXXXX" get sid
    
    *************************************
    "Windows Updates"
    -----------------
    -Check for all installed KB's-
    wmic qfe list
    
    Install-Module PSWindowsUpdate [type A]
    Get-WindowsUpdate
    Install-WindowsUpdate
    Get-WindowsUpdate -AcceptAll -Install -AutoReboot
    
    Get-WindowsUpdate -Install -KBArticleID 'KB5021233'
    *************************************
    
    "delete deleted users" MO365
    Powershell scripts for MSOL

To check version of PS 
Get-Host

Install-Module MSOnline

To check: 
Get-InstalledModule

Install-Module MSOnline

$Msolcred = Get-credential
Connect-MsolService -Credential $MsolCred

Get-MsolUser –ReturnDeletedUsers

Remove-MsolUser –UserPrincipalName [username] –RemoveFromRecycleBin 

Get-MsolUser -ReturnDeletedUsers | Remove-MsolUser -RemoveFromRecycleBin

Get-MsolUser -ReturnDeletedUsers | Remove-MsolUser -RemoveFromRecycleBin -Force
